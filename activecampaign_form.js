window.addEventListener("DOMContentLoaded",function(){const AC_U="4",AC_F="4",AC_ACTION="https://bazardesportivo.activehosted.com/proc.php",MAP={fullname:"cms_field_30",email:"cms_field_31",genero:"cms_field_33",tipo:"cms_field_156",consent:"cms_field_42",dob:"cms_field_64"},AC_DOB_FIELD_NAME=null,form=document.getElementById("cms_frm1899545180")||document.querySelector("form.cms_frm");if(!form){console.warn("Formulário não encontrado");return}const msgOk=form.querySelector(".form-message .success"),msgErrDefault=form.querySelector(".form-message .error-default"),submitBtn=form.querySelector('button[type="submit"], .submit');function val(e){const t=form.querySelector(`[name="${e}"]`);if(!t)return"";if("radio"===t.type){const e=form.querySelector(`[name="${e}"]:checked`);return e?e.value:""}return"checkbox"===t.type?t.checked?(t.value||"1"):"":(t.value||"").trim()}function showSuccess(){msgOk&&(msgOk.style.display="",window.scrollTo({top:msgOk.getBoundingClientRect().top+window.scrollY-120,behavior:"smooth"}))}function showError(){msgErrDefault&&(msgErrDefault.style.display="",window.scrollTo({top:msgErrDefault.getBoundingClientRect().top+window.scrollY-120,behavior:"smooth"}))}function setLoading(e){submitBtn&&(submitBtn.classList.toggle("loader",!!e),submitBtn.disabled=!!e)}const iframeName="ac_iframe_"+Math.random().toString(36).slice(2),iframe=document.createElement("iframe");iframe.name=iframeName,iframe.style.display="none",document.body.appendChild(iframe);const acForm=document.createElement("form");acForm.action=AC_ACTION,acForm.method="POST",acForm.target=iframeName,acForm.style.display="none";const hiddenPairs={u:AC_U,f:AC_F,s:"",c:"0",m:"0",act:"sub",v:"2"};Object.entries(hiddenPairs).forEach(([e,t])=>{const n=document.createElement("input");n.type="hidden",n.name=e,n.value=t,acForm.appendChild(n)}),form.addEventListener("submit",function(e){const t=val(MAP.email),n=val(MAP.consent),o=val(MAP.genero),a=val(MAP.tipo),i=/^[+_a-z0-9-'&=]+(\.[+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*\.[a-z]{2,}$/i;(!t||!i.test(t)||!n||!o||!a||"0"===a)&&showError(),e.preventDefault(),setLoading(!0);for(;acForm.firstChild;)acForm.removeChild(acForm.firstChild);Object.entries(hiddenPairs).forEach(([e,t])=>{const n=document.createElement("input");n.type="hidden",n.name=e,n.value=t,acForm.appendChild(n)});function d(e,t){const n=document.createElement("input");n.type="hidden",n.name=e,n.value=t,acForm.appendChild(n)}d("fullname",val(MAP.fullname)),d("email",t),d("field[13]",o),d("field[6]",a),AC_DOB_FIELD_NAME&&(()=>{const e=val(MAP.dob);e&&d(AC_DOB_FIELD_NAME,e)})();const r=new URLSearchParams(location.search);["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(e=>{const t=r.get(e);t&&d(e,t)}),document.body.appendChild(acForm);const l=()=>{iframe.removeEventListener("load",l),setLoading(!1),showSuccess();try{form.reset()}catch(e){}};iframe.addEventListener("load",l),acForm.submit()}),console.log("Integração ActiveCampaign pronta (via iframe hidden).")});
