(function(){const AC={domain:"https://bazardesportivo.activehosted.com",hidden:{u:"1",f:"1",s:"",c:"0",m:"0",act:"sub",v:"2",or:"9b1dc3f6-bcc6-4006-ae74-81db51d6d414"}},qs=(e,t=document)=>t.querySelector(e),qsa=(e,t=document)=>Array.from(t.querySelectorAll(e)),isEmail=e=>/^[+_a-z0-9-'&=]+(\.[+_a-z0-9-']+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,})$/i.test(e),getParam=e=>{const t=new URLSearchParams(location.search);return t.get(e)||""},I18N={pt:{q1_title:"QUESTÃO 1",q1_desc:"Queremos dar-te um presente. Qual é a tua data de nascimento?",dob_ph:"DIA/MÊS/ANO",next:"Avançar",q2_title:"QUESTÃO 2",q2_desc:"Qual é o teu estilo de preferência?",style_w:"Mulher",style_m:"Homem",style_b:"Ambos",q3_title:"QUESTÃO 3",q3_desc:"Que tipo de comunicação preferes receber?",comm_f:"Moda",comm_s:"Desporto",comm_b:"Ambos",q4_title:"QUESTÃO 4",q4_desc:"Quais são as tuas modalidades favoritas?",sports_all:"Seleciona todas",s_football:"Futebol",s_running:"Running (Corrida)",s_gym:"Fitness e Training (Ginásio)",s_swim:"Natação",s_futsal:"Futsal",s_trail:"Trail",s_padel:"Padel",s_tennis:"Ténis",submit:"Avançar",thank_title:"OBRIGADA PELAS TUAS RESPOSTAS!",thank_desc:"Verifica o teu email! Enviámos-te um código 15% de desconto para gastares na nossa loja online.",gate_title:"Abre este formulário pelo link do email",gate_desc:"Para continuares, abre o formulário pelo link único que te enviámos no email da campanha. Se não o encontrares, verifica a pasta de spam.",gate_btn:"Já abri pelo link",err_dob_invalid:"Introduz uma data válida no formato DD/MM/AAAA.",err_dob_future:"A data não pode ser no futuro.",err_select_opt:"Seleciona uma opção.",err_select_sport:"Seleciona pelo menos uma modalidade.",toast_saved:"Preferências guardadas.",toast_need_link:"Abre este formulário pelo link da campanha (com ?email=…)",toast_csp:"Bloqueado por CSP/rede",toast_timeout:"Sem resposta do servidor. Tenta novamente.",toast_send_error:"Falha no envio."}},getLang=e=>{const t=(e||"").toLowerCase(),n=(getParam("lang")||"").toLowerCase();let o="";try{const e=document.currentScript||[...document.querySelectorAll("script")].pop();o=(e?.dataset?.shopLang||"").toLowerCase()}catch(e){}const a=(document.documentElement.getAttribute("lang")||"").toLowerCase().split("-")[0];return[t,n,o,a,"pt"].find(e=>e&&I18N[e])||"pt"},b64urlDecode=e=>{if(!e)return"";try{for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4;)e+="=";return atob(e)}catch(e){return""}},getEmail=()=>{const e=getParam("email");if(e&&isEmail(e))return e;const t=getParam("e");if(t){const e=b64urlDecode(t.trim());if(e&&isEmail(e))return e}try{const e=localStorage.getItem("bzr_ac_email");if(e&&isEmail(e))return e}catch(e){}const n=document.cookie.match(/(?:^|; )bzr_ac_email=([^;]+)/);if(n){const e=decodeURIComponent(n[1]);if(isEmail(e))return e}return""},setEmail=e=>{try{localStorage.setItem("bzr_ac_email",e)}catch(e){}const t="https:"===location.protocol?"; Secure":"";document.cookie=`bzr_ac_email=${encodeURIComponent(e)}; expires=${new Date(Date.now()+31536e6).toUTCString()}; path=/; SameSite=Lax${t}`},toDobISO=e=>{if(!e)return"";e=e.trim();if(/^\d{4}-\d{2}-\d{2}$/.test(e)){const[t,n,o]=e.split("-").map(Number),a=new Date(t,n-1,o);return a.getFullYear()===t&&a.getMonth()===n-1&&a.getDate()===o?e:""}const t=e.match(/^(\d{1,2})\D(\d{1,2})\D(\d{4})$/);if(!t)return"";const n=+t[1],o=+t[2],a=+t[3],r=new Date(a,o-1,n);return r.getFullYear()!==a||r.getMonth()!==o-1||r.getDate()!==n?"":`${String(a).padStart(4,"0")}-${String(o).padStart(2,"0")}-${String(n).padStart(2,"0")}`},enc=e=>{const t=[];for(const[n,o]of Object.entries(e))Array.isArray(o)?o.forEach(e=>t.push(`${encodeURIComponent(n)}=${encodeURIComponent(e)}`)):t.push(`${encodeURIComponent(n)}=${encodeURIComponent(o??"")}`);return t.join("&")},toast=e=>{let t=qs("#bzr_toast");t||(t=document.createElement("div"),t.id="bzr_toast",t.className="toast",document.body.appendChild(t)),t.textContent=e,t.classList.add("show"),setTimeout(()=>t.classList.remove("show"),4e3)};function inject(e={}){const t=getLang(e.lang),n=I18N[t],o=document.createElement("style");o.appendChild(document.createTextNode("")),document.head.appendChild(o);const a="string"==typeof e.mount?qs(e.mount):e.mount||document.body,r=document.createElement("div");r.className="form-container bzr-form",r.id="bzr-form",r.innerHTML=`<div class="step active" id="step1"><div class="overlay"><div class="content-box"><h2>${n.q1_title}</h2><p>${n.q1_desc}</p><input type="text" placeholder="${n.dob_ph}" id="dob" /><div id="err_dob" class="err-msg" style="display:none" role="alert" aria-live="assertive"></div><button class="next-btn" data-next="#step2">${n.next}</button></div></div></div>`,a.appendChild(r),qs("#dob",r).addEventListener("blur",()=>{const e=qs("#dob",r).value;if(toDobISO(e)==="")toast(n.err_dob_invalid)})}window.BZRLeadForm={init:(e={})=>inject(e)},document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>BZRLeadForm.init({mount:".wrapper-page"})):BZRLeadForm.init({mount:".wrapper-page"})})();
